- name: Deploy resources to EKS cluster
  hosts: localhost
  become: true
  tasks:
    - name: Include service YAML
      include_vars:
        file: service.yaml

    - name: Include pod YAML
      include_vars:
        file: pod.yaml

    - name: Include deployment YAML
      include_vars:
        file: deployment.yaml

    - name: Apply service configuration
      kubernetes.core.k8s:
        state: present
        definition: "{{ Service }}"
        name: "{{ Service.metadata.name }}"
        kubeconfig: /home/ubuntu/.kube/config

    - name: Apply pod configuration
      kubernetes.core.k8s:
        state: present
        definition: "{{ Pod }}"
        name: "{{ Pod.metadata.name }}"
        kubeconfig: /home/ubuntu/.kube/config

    - name: Apply deployment configuration
      kubernetes.core.k8s:
        state: present
        definition: "{{ Deployment }}"
        name: "{{ Deployment.metadata.name }}"
        kubeconfig: /home/ubuntu/.kube/config
